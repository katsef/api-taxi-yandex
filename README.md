![](https://storage.yandexcloud.net/webazon/github/yandex_pro.webp)

# api-taxi-yandex

## PHP библиотека для парков-партнёров по взаимодействию через [API Яндекс.Такси](https://fleet.taxi.yandex.ru/api/docs/concepts/index.html) с дополнительными методами.

## Установка

Можно установить используя менеджер пакетов [Composer](https://getcomposer.org)

```bash
$ composer require webazon/api-taxi-yandex
```

или скачать пакет с [GitHub](https://github.com/katsef/api-taxi-yandex)

------

## Инициализация

```php
require __DIR__ . '/vendor/autoload.php';

$parkId = 'ВАШ_ИД_ПАРКА';
$apiKey = 'ВАШ_API_КЛЮЧ';

$client = new Webazon\ApiTaxiYandex\Client($parkId,$apiKey);
```

------

## Ответ на запрос

В ответе на любой запрос содержится объект формата:

- **headers** (object) - заголовок ответа сервера

  - **http** (object) 
    - **protocol** (string) - протокол
    - **result_code** (integer) - код ответа сервера
    - **message** (string) - сообщение
    
  - **content-length** (integer) - размер тела ответа
  
  - **content-type** (string)
  
  - **date** (string)
  
  - **vary** (string)
  
  - **x-yarequestid** (string) - ID запроса в системе Яндекс
  
- **body** (object) - само тело ответа в соответсвии с описанием в оф.документации

  
  
  ## Коды ответа от сервера Яндекс
  
  ###### возвращаются в теле ответа
  
  ```
  {
   headers: {
       	  http: {
                  result_code: "код ответа"
            	    }
   		  }
  }
  ```
  
  ###### 

| КОД  | ПРИЧИНА             | ОПИСАНИЕ                                                   |
| :--- | ------------------- | ---------------------------------------------------------- |
| 200  | OK                  | Запрос выполнен успешно                                    |
| 400  | BadRequest          | Некорректные параметры запроса                             |
| 401  | Unauthorized        | Отсутствуют параметры авторизации                          |
| 403  | Forbidden           | Не достаточно прав для выполнения запроса                  |
| 404  | NotFound            | Ресурс не найден                                           |
| 409  | Conflict            | Операция не может быть выполнена из-за конфликта изменений |
| 429  | TooManyRequests     | Превышены ограничения (см. ограничения ниже)               |
| 500  | InternalServerError | Внутренняя ошибка сервера                                  |

Если код ответа отличный от 200, то в теле ответа придёт сообщение об ошибке в формате:

```json
{"message": "поле с сообщением об ошибке"}
```

## Ограничения

**При использовании API действуют ограничения:**

* Не более 2 запросов в секунду
* Не более 5000 запросов в час

При превышении ограничений возвращается код `429 Too Many Requests`.

------



## Список доступных методов

### Автомобили

#### Список автомобилей
[API метод в оф.документации](https://fleet.taxi.yandex.ru/api/docs/reference/Cars/v1_parks_cars_list_post.html) 

object **all** ( [object *$fields*] ,[object *$query*], [ int *$offset* ], [ int *$limit* ] )

```php
$cars = $client->api('cars')->all();
```

**Список необязательных параметров**

***fields***         -  Данные, которые необходимо извлечь

***query***         - Поисковые ограничения

***offset***        - Отступ, начиная с которого возвращаются автомобили в ответе

***limit***          - Ограничение сверху на число автомобилей в ответе

------

### Водители

#### Список всех профилей водителей
[API метод в оф.документации](https://fleet.taxi.yandex.ru/api/docs/reference/DriverProfiles/v1_parks_driver-profiles_list_post.html) 

array **all** ( [array *$fields*] ,[array *$query*], [ int *$offset ], [ int *$limit* ] )

```php
$drivers = $client->api('drivers')->all();
```

**Список необязательных параметров**

***fields***        -  Данные, которые необходимо извлечь

***query***        - Поисковые ограничения

***offset***        - Отступ, начиная с которого возвращаются водители в ответе

***limit***          - Ограничение сверху на число водителей в ответе

------

Дополнительно в поле ***"balances"*** возвращается общая сумма всех балансов водителей, что важно для поддержания необходимого остатка на депозите парка для обеспечения бесперебойных выплат водителям.

------



**Проект находится в разработке. Новые методы будут появляться по мере реализации.**

------




## ![](https://storage.yandexcloud.net/webazon/github/massachusetts_institute_of_technology.png) License  

  ```русский
  © 2022 ИП Кацеф Алексей Михайлович
  ```

>  Настоящим предоставляется бесплатное разрешение любому лицу, получившему копию
  данного программного обеспечения и связанных с ним файлов документации ("Программное обеспечение"), использовать в Программном обеспечении без ограничений, включая, помимо прочего, права копировать, изменять, объединять, публиковать, распространять, сублицензировать и/или продавать копий Программного обеспечения, а также разрешить лицам, которым Программное обеспечение предоставляется для этого при соблюдении следующих условий:
>  Вышеприведенное уведомление об авторских правах и это уведомление о разрешении должны быть включены во все копии или существенные части Программного обеспечения.
>  ПРОГРАММНОЕ ОБЕСПЕЧЕНИЕ ПРЕДОСТАВЛЯЕТСЯ «КАК ЕСТЬ», БЕЗ КАКИХ-ЛИБО ГАРАНТИЙ, ЯВНЫХ ИЛИ ПОДРАЗУМЕВАЕТСЯ, ВКЛЮЧАЯ, ПОМИМО ПРОЧЕГО, ГАРАНТИИ КОММЕРЧЕСКОЙ ЦЕННОСТИ, ПРИГОДНОСТЬ ДЛЯ ОПРЕДЕЛЕННОЙ ЦЕЛИ И НЕНАРУШЕНИЕ ПРАВ. НИ ПРИ КАКИХ ОБСТОЯТЕЛЬСТВАХ АВТОРЫ ИЛИ ВЛАДЕЛЕЦ АВТОРСКИХ ПРАВ НЕ НЕСУТ ОТВЕТСТВЕННОСТЬ ЗА ЛЮБЫЕ ПРЕТЕНЗИИ, УЩЕРБ ИЛИ ДРУГОЕ. ОТВЕТСТВЕННОСТЬ, БУДУЩАЯ ПО ДОГОВОРУ, ДЕЛИКТУ ИЛИ ИНЫМ ОБРАЗОМ, ВОЗНИКАЮЩАЯ ИЗ, ВНЕ ИЛИ В СВЯЗИ С ПРОГРАММНЫМ ОБЕСПЕЧЕНИЕМ ИЛИ ИСПОЛЬЗОВАНИЕМ ИЛИ ДРУГИМИ СДЕЛКАМИ В ПРОГРАММНОГО ОБЕСПЕЧЕНИЯ.



  